var $=(b,r,i)=>new Promise((u,y)=>{var t=l=>{try{m(i.next(l))}catch(f){y(f)}},x=l=>{try{m(i.throw(l))}catch(f){y(f)}},m=l=>l.done?u(l.value):Promise.resolve(l.value).then(t,x);m((i=i.apply(b,r)).next())});import{d as N,f as S,r as A,c as P,u as e,Z as G,_ as O,m as E,A as L,k as s,a9 as a,G as d,a0 as c,$ as U,a1 as V,al as q,F as H}from"./vue-gN4NnATS.js";import{u as K,a as W,b as j,L as w,_ as Q}from"./LoginFormTitle.vue_vue_type_script_setup_true_lang-mZeYjFpn.js";import{h as X,f as Y,l as Z,r as J,b as ee}from"./entry/index-BEncmqB6-1717590836513.js";import{a5 as R,E as D,a6 as se,B as p,a7 as ae,a8 as oe,a9 as te,aa as le,ab as ne,ac as re,Y as ie,X as ue}from"./antd-B_Joh_oh.js";const pe=N({__name:"LoginForm",setup(b){const r=ie,i=ue,u=R.Item,y=D.Password,{t}=X(),{notification:x,createErrorModal:m}=ee(),{prefixCls:l}=Y("login"),f=Z(),{setLoginState:_,getLoginState:T}=K(),B=()=>{J.push("/dashboard/workbench")},{getFormRules:z}=W(),C=S(),k=S(!1),F=S(!1),g=A({account:"",password:""}),{validForm:M}=j(C),I=P(()=>e(T)===w.LOGIN);function h(){return $(this,null,function*(){const v=yield M();if(v)try{k.value=!0;const o=yield f.login({password:v.password,username:v.account,mode:"none"});o&&x.success({message:t("sys.login.loginSuccessTitle"),description:`${t("sys.login.loginSuccessDesc")}: ${o.realName}`,duration:3})}catch(o){m({title:t("sys.api.errorTip"),content:o.message||t("sys.api.networkExceptionMsg"),getContainer:()=>document.body.querySelector(`.${l}`)||document.body})}finally{k.value=!1}})}return(v,o)=>(G(),O(H,null,[E(s(Q,{class:"enter-x"},null,512),[[L,I.value]]),E(s(e(R),{class:"p-4 enter-x",model:g,rules:e(z),ref_key:"formRef",ref:C,onKeypress:q(h,["enter"])},{default:a(()=>[s(e(u),{name:"account",class:"enter-x"},{default:a(()=>[s(e(D),{size:"large",value:g.account,"onUpdate:value":o[0]||(o[0]=n=>g.account=n),placeholder:e(t)("sys.login.userName"),class:"fix-auto-fill"},null,8,["value","placeholder"])]),_:1}),s(e(u),{name:"password",class:"enter-x"},{default:a(()=>[s(e(y),{size:"large",visibilityToggle:"",value:g.password,"onUpdate:value":o[1]||(o[1]=n=>g.password=n),placeholder:e(t)("sys.login.password")},null,8,["value","placeholder"])]),_:1}),s(e(i),{class:"enter-x"},{default:a(()=>[s(e(r),{span:12},{default:a(()=>[s(e(u),null,{default:a(()=>[s(e(se),{checked:F.value,"onUpdate:checked":o[2]||(o[2]=n=>F.value=n),size:"small"},{default:a(()=>[d(c(e(t)("sys.login.rememberMe")),1)]),_:1},8,["checked"])]),_:1})]),_:1}),s(e(r),{span:12},{default:a(()=>[s(e(u),{style:{"text-align":"right"}},{default:a(()=>[s(e(p),{type:"link",size:"small",onClick:o[3]||(o[3]=n=>e(_)(e(w).RESET_PASSWORD))},{default:a(()=>[d(c(e(t)("sys.login.forgetPassword")),1)]),_:1})]),_:1})]),_:1})]),_:1}),s(e(u),{class:"enter-x"},{default:a(()=>[s(e(p),{type:"primary",size:"large",block:"",onClick:h,loading:k.value},{default:a(()=>[d(c(e(t)("sys.login.loginButton")),1)]),_:1},8,["loading"])]),_:1}),s(e(i),{class:"enter-x",gutter:[16,16]},{default:a(()=>[s(e(r),{md:8,xs:24},{default:a(()=>[s(e(p),{block:"",onClick:o[4]||(o[4]=n=>e(_)(e(w).MOBILE))},{default:a(()=>[d(c(e(t)("sys.login.mobileSignInFormTitle")),1)]),_:1})]),_:1}),s(e(r),{md:8,xs:24},{default:a(()=>[s(e(p),{block:"",onClick:o[5]||(o[5]=n=>e(_)(e(w).QR_CODE))},{default:a(()=>[d(c(e(t)("sys.login.qrSignInFormTitle")),1)]),_:1})]),_:1}),s(e(r),{md:8,xs:24},{default:a(()=>[s(e(p),{block:"",onClick:o[6]||(o[6]=n=>B())},{default:a(()=>[d(c(e(t)("sys.login.goHome")),1)]),_:1})]),_:1})]),_:1}),s(e(ae),{class:"enter-x"},{default:a(()=>[d(c(e(t)("sys.login.otherSignIn")),1)]),_:1}),U("div",{class:V(["flex justify-evenly enter-x",`${e(l)}-sign-in-way`])},[s(e(oe)),s(e(te)),s(e(le)),s(e(ne)),s(e(re))],2)]),_:1},8,["model","rules"]),[[L,I.value]])],64))}});export{pe as _};
