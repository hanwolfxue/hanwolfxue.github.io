import{P as le}from"./index-CaS5ecGD.js";import{a as $,_ as se}from"./entry/index-nrenXBHR-1717431353170.js";import{h as re,U as R,V as ue}from"./antd-BHcOFGwY.js";import{d as A,f as i,r as ce,a7 as s,Z as d,a8 as V,a9 as n,$ as k,k as t,G as x,_ as C,F as G,aa as H,ag as L,ab as W,a0 as ie,u as q}from"./vue-BR4kA91-.js";import"./useContentViewHeight-DWJbGTOw.js";import"./useWindowSizeFn-CJLxKXUm.js";import"./onMountedOrActivated-Ct_sYMl9.js";const de={style:{display:"flex","justify-content":"center"}},pe=["src"],me=["href","onClick"],fe=["onClick"],_e=["onClick"],ve=A({__name:"index",setup(ge){const[w,Z]=re.useNotification(),K=A({props:{vnodes:{type:Object,required:!0}},render(){return this.vnodes}}),f=i(""),_=i([]),B=i([]),o=ce({id:"",categoryName:"",url:"",urlName:"",favicon:""}),O=i(),p=i(),U=i([]),M={categoryName:[{required:!0,message:"请选择收藏夹"}],url:[{required:!0,message:"请输入链接"}],urlName:[{required:!0,message:"请输入链接名称"}],favicon:[{required:!1,message:"请输入favicon地址"}]},v=i(!1),D=()=>{$.get(`${S}api/bookmarks`).then(a=>{const e=R(a,"data");e.success?(_.value=e.data,U.value=e.data.map(r=>r.categoryName),B.value=JSON.parse(JSON.stringify(e.data))):w.info({message:e.code,description:e.message,placement:"topRight"})})},Q=a=>{a.preventDefault(),p.value&&(U.value.push(p.value),p.value="",setTimeout(()=>{var e;(e=O.value)==null||e.focus()},0))},X=(a,e)=>{a.preventDefault(),$.delete(`${S}api/bookmarks/${e.id}`).then(r=>{const u=R(r,"data");u.success?D():w.info({message:u.code,description:u.message,placement:"topRight"})})},Y=(a,e,r)=>{a.preventDefault(),T({id:r.id,categoryName:e.categoryName,urlName:r.name,url:r.url,favicon:r.favicon})},T=a=>{o.id=a==null?void 0:a.id,o.categoryName=a==null?void 0:a.categoryName,o.urlName=a==null?void 0:a.urlName,o.url=a==null?void 0:a.url,o.favicon=a==null?void 0:a.favicon,v.value=!0},J=()=>{v.value=!1},b=()=>{v.value=!1,$[o.id?"put":"post"](`${S}api/bookmarks/${o.id?o.id:""}`,o).then(a=>{const e=R(a,"data");e.success?D():w.info({message:e.code,description:e.message,placement:"topRight"})})},S="https://1.94.182.143:8000/";D();const j=(a,e)=>{a.preventDefault(),window.open(e,"_blank")},P=()=>{ue(()=>{f.value?_.value.forEach(e=>{e.urls=e.urls.filter(r=>r.name.includes(f.value))}):_.value=JSON.parse(JSON.stringify(B.value))},500)()};return(a,e)=>{const r=s("a-input-search"),u=s("a-button"),E=s("a-card"),ee=s("a-divider"),g=s("a-input"),ae=s("plus-outlined"),F=s("a-space"),te=s("a-select"),y=s("a-form-item"),N=s("a-col"),I=s("a-row"),ne=s("a-form"),oe=s("a-drawer");return d(),V(q(le),{title:"工作书签"},{default:n(()=>[k("div",de,[t(r,{value:f.value,"onUpdate:value":e[0]||(e[0]=l=>f.value=l),placeholder:"请输入网站名称",style:{width:"600px","margin-bottom":"16px"},"enter-button":"",onSearch:P,onChange:P},null,8,["value"]),t(u,{type:"primary",style:{"margin-left":"5px"},onClick:T},{default:n(()=>[x("新增")]),_:1})]),(d(!0),C(G,null,H(_.value,(l,h)=>(d(),C("div",{key:h,style:L({marginTop:h!==0?"16px":"0px"})},[l.urls.length?(d(),V(E,{key:0,title:l.categoryName},{default:n(()=>[(d(!0),C(G,null,H(l.urls,(c,z)=>(d(),V(E,{key:z,style:L({marginTop:z!==0?"16px":"0px"})},{default:n(()=>[c.favicon?(d(),C("img",{key:0,src:c.favicon,alt:"链接",class:"favicon"},null,8,pe)):W("",!0),k("a",{href:c.url,onClick:m=>j(m,c.url)},ie(c.name),9,me),k("a",{style:{padding:"0 5px",float:"right"},onClick:m=>X(m,c)},"删除",8,fe),k("a",{style:{padding:"0 5px",float:"right"},onClick:m=>Y(m,l,c)},"编辑",8,_e)]),_:2},1032,["style"]))),128))]),_:2},1032,["title"])):W("",!0)],4))),128)),t(oe,{title:"新增书签",width:720,open:v.value,"body-style":{paddingBottom:"80px"},"footer-style":{textAlign:"right"},onClose:J},{extra:n(()=>[t(F,null,{default:n(()=>[t(u,{onClick:J},{default:n(()=>[x("取消")]),_:1}),t(u,{type:"primary",onClick:b},{default:n(()=>[x("保存")]),_:1})]),_:1})]),default:n(()=>[t(ne,{model:o,rules:M,layout:"vertical"},{default:n(()=>[t(I,{gutter:16},{default:n(()=>[t(N,{span:12},{default:n(()=>[t(y,{label:"收藏夹",name:"name"},{default:n(()=>[t(te,{value:o.categoryName,"onUpdate:value":e[2]||(e[2]=l=>o.categoryName=l),placeholder:"请选择收藏夹",options:U.value.map(l=>({value:l}))},{dropdownRender:n(({menuNode:l})=>[t(q(K),{vnodes:l},null,8,["vnodes"]),t(ee,{style:{margin:"4px 0"}}),t(F,{style:{padding:"4px 8px"}},{default:n(()=>[t(g,{ref_key:"inputRef",ref:O,value:p.value,"onUpdate:value":e[1]||(e[1]=h=>p.value=h),placeholder:"请输入收藏夹名"},null,8,["value"]),t(u,{type:"text",onClick:Q},{icon:n(()=>[t(ae)]),default:n(()=>[x(" 新增 ")]),_:1})]),_:1})]),_:1},8,["value","options"])]),_:1})]),_:1}),t(N,{span:12},{default:n(()=>[t(y,{label:"链接名称",name:"urlName"},{default:n(()=>[t(g,{value:o.urlName,"onUpdate:value":e[3]||(e[3]=l=>o.urlName=l),style:{width:"100%"},placeholder:"请输入链接名称"},null,8,["value"])]),_:1})]),_:1})]),_:1}),t(I,{gutter:16},{default:n(()=>[t(N,{span:12},{default:n(()=>[t(y,{label:"链接",name:"url"},{default:n(()=>[t(g,{value:o.url,"onUpdate:value":e[4]||(e[4]=l=>o.url=l),style:{width:"100%"},placeholder:"请输入链接地址"},null,8,["value"])]),_:1})]),_:1}),t(N,{span:12},{default:n(()=>[t(y,{label:"favicon",name:"favicon"},{default:n(()=>[t(g,{value:o.favicon,"onUpdate:value":e[5]||(e[5]=l=>o.favicon=l),style:{width:"100%"},placeholder:"请输入favicon地址"},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["open"]),t(q(Z))]),_:1})}}}),Ue=se(ve,[["__scopeId","data-v-ba1e9a8c"]]);export{Ue as default};
